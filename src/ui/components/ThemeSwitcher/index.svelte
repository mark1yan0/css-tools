<script lang="ts">
    import themeManager from "@/state/theme/index.svelte";
    import cursorNotice from "@/state/cursor/index.svelte";

    function clickHandler() {
        themeManager.switch();
        cursorNotice.hide();
    }

    // TODO: refactor (see Field)
    let timeout = $state<NodeJS.Timeout | null>(null);
    function mouseOverHandler() {
        timeout = setTimeout(() => {
            cursorNotice.info(
                `Switch to ${themeManager.isDark() ? "light" : "dark"} theme`,
            );
        }, 1500);
    }

    function mouseOutHandler() {
        cursorNotice.hide();
        if (!timeout) {
            return;
        }

        clearTimeout(timeout);
        timeout = null;
    }
</script>

<button
    onclick={clickHandler}
    onfocus={mouseOverHandler}
    onblur={mouseOutHandler}
    onmouseover={mouseOverHandler}
    onmouseout={mouseOutHandler}
    class="hover:scale-110 transition-all"
>
    {#if themeManager.isDark()}
        <svg
            width="15"
            height="16"
            viewBox="0 0 15 16"
            fill="none"
            xmlns="http://www.w3.org/2000/svg"
        >
            <path
                d="M0.454291 10.5684C-1.71788 4.26581 4.28754 -1.44952 10.2291 0.329267C10.9823 0.554603 11.6917 0.848221 11.4698 1.36376C11.2714 1.83492 10.7839 1.67787 9.93989 1.74615C6.416 2.03977 3.95465 5.25592 5.21895 8.90226C6.416 12.3676 10.4275 13.4704 13.3091 11.4219C13.9749 10.9508 14.3515 10.6571 14.7483 10.903C15.3031 11.241 14.8155 12.0057 14.4826 12.5452C11.6447 17.1577 2.93582 17.7654 0.450936 10.565L0.454291 10.5684Z"
            />
        </svg>
    {:else}
        <svg
            width="18"
            height="18"
            viewBox="0 0 18 18"
            fill="none"
            xmlns="http://www.w3.org/2000/svg"
        >
            <path
                d="M0 8.97845C0 8.32197 0.437484 7.79812 1.09372 7.79812C1.83612 7.79812 2.3167 8.19267 4.10974 8.4977C4.89523 8.63032 5.09409 8.73642 5.09409 9.00166C5.09409 9.28679 4.89854 9.4161 4.08985 9.52551C2.27693 9.76754 1.79635 10.1389 1.05395 10.1389C0.4408 10.1389 0.00662497 9.63492 0.00662497 8.98176L0 8.97845ZM2.53544 15.2315C2.07807 14.774 2.01178 14.1175 2.49236 13.6368C3.01602 13.1129 3.67225 13.0897 5.13718 12.0619C5.79341 11.6043 6.03204 11.5148 6.2077 11.7138C6.40324 11.9326 6.34027 12.1945 5.81329 12.8079C4.6334 14.1838 4.6102 14.8171 4.08654 15.3443C3.64905 15.7819 3.01602 15.7156 2.53544 15.2348V15.2315ZM5.20014 5.8088C3.75842 4.67158 3.19168 4.58537 2.6647 4.06152C2.22721 3.62387 2.3167 2.99061 2.79727 2.50985C3.25465 2.05231 3.91088 2.00589 4.39146 2.48665C4.91512 3.0105 4.91511 3.66697 5.94255 5.13244C6.39992 5.78891 6.48941 6.02763 6.29055 6.20335C6.07181 6.39897 5.83318 6.31277 5.19683 5.8088H5.20014ZM6.14141 9.00166C6.14141 7.42678 7.40748 6.14036 9.00497 6.14036C10.6025 6.14036 11.8453 7.4301 11.8453 9.00166C11.8453 10.5732 10.5793 11.8663 9.00497 11.8663C7.43068 11.8663 6.14141 10.5765 6.14141 9.00166ZM7.82176 16.9125C7.82176 16.1698 8.19297 15.6891 8.49788 13.8954C8.63046 13.1096 8.73982 12.9107 9.00165 12.9107C9.28668 12.9107 9.41594 13.1063 9.52532 13.9153C9.76726 15.7289 10.1583 16.2096 10.1583 16.9523C10.1583 17.5657 9.65457 18 9.00165 18C8.34874 18 7.82176 17.5624 7.82176 16.9059V16.9125ZM8.478 4.08473C8.23605 2.27114 7.84496 1.79039 7.84496 1.04771C7.84496 0.434334 8.34874 0 9.00165 0C9.65457 0 10.1816 0.43765 10.1816 1.09412C10.1816 1.8368 9.81035 2.31755 9.50543 4.11125C9.37286 4.89703 9.26348 5.09597 9.00165 5.09597C8.71662 5.09597 8.58737 4.90035 8.478 4.09136V4.08473ZM12.0608 12.8709C11.6034 12.2144 11.5139 11.9757 11.7128 11.8C11.9315 11.6043 12.1701 11.6906 12.8065 12.1945C14.2482 13.3317 14.8149 13.4179 15.3419 13.9418C15.7794 14.3794 15.6899 15.0127 15.2094 15.4935C14.752 15.951 14.0957 15.9974 13.6152 15.5167C13.0915 14.9928 13.0915 14.3363 12.0641 12.8709H12.0608ZM12.19 5.19875C13.3699 3.8228 13.3931 3.18954 13.9168 2.66237C14.3543 2.22472 14.9873 2.29103 15.4679 2.77178C15.9252 3.22932 15.9915 3.8858 15.511 4.36655C14.9873 4.8904 14.3311 4.91361 12.8661 5.94143C12.2099 6.39897 11.9713 6.48849 11.7956 6.28956C11.6001 6.07073 11.663 5.8088 12.19 5.19543V5.19875ZM13.8969 9.5023C13.1114 9.36968 12.9125 9.26027 12.9125 8.99834C12.9125 8.71321 13.1081 8.5839 13.9168 8.47449C15.7297 8.23577 16.2103 7.86112 16.9527 7.86112C17.5658 7.86112 18 8.36508 18 9.01824C18 9.67139 17.5625 10.1986 16.9063 10.1986C16.1639 10.1986 15.6833 9.80402 13.8903 9.49899L13.8969 9.5023Z"
            />
        </svg>
    {/if}
</button>
